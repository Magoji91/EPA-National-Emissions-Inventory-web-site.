Of the four types of sources indicated by the type (point, nonpoint, onroad, nonroad) variable, which of these four sources have seen decreases in emissions from 1999–2008 for Baltimore City? Which have seen increases in emissions from 1999–2008? Use the ggplot2 plotting system to make a plot answer this question.

I-) Nonpoint (green line):Sharply decreased from 1999 to 2002. It remained steady from 2002 to 2005 with 1,500 Total \(PM_{2.5}\) emissions. Finally, a slight decrease occurred between 2005 and 2008 from 1,500 Total \(PM_{2.5}\) emissions.

II-) Point (purple line): Slightly increased from 1999 to 2002. It then sharply increased in \(PM_{2.5}\) emissions from 2002 to 2005. Finally, from 2005 to 2008, the \(PM_{2.5}\) emissions sharply decreased.

III-) Onroad (blue line): Slightly decreased from 1999 to 2002. It remained approximately steady from 2002 to 2005 and continued this trend from 2005 to 2008. In comparison to the nonroad values, this over all trend was lower compared to the nonroad values.

IV-) Nonroad (red line): Followed the same path as the onroad values only slightly higher in \(PM_{2.5}\) emissions values. slightly decreased from 1999 to 2002. It remained approximately steady from 2002 to 2005 and continued this trend from 2005 to 2008.


Baltimore <- NEI[NEI$fips == "24510", ]
emissionsByTypeAndYear <- aggregate(Emissions ~ type * year, data = Baltimore, 
    FUN = sum)

suppressWarnings(library(ggplot2))
suppressWarnings(library(grid))

q <- qplot(y = Emissions, x = year, data = emissionsByTypeAndYear, color = type, 
    facets = . ~ type)
q + scale_x_continuous(breaks = seq(1999, 2008, 3)) + theme_bw() + geom_point(size = 3) + 
    geom_line() + labs(y = expression("Total " * PM[2.5] * " Emissions (in tons)")) + 
    labs(x = "Year") + labs(title = expression("Total " * PM[2.5] * " Emissions in Baltimore (1999 - 2008)")) + 
    theme(axis.text = element_text(size = 8), axis.title = element_text(size = 14), 
        panel.margin = unit(1, "lines"), plot.title = element_text(vjust = 2), 
        legend.title = element_text(size = 11)) + scale_colour_discrete(name = "Type")
        
OBSERVATION - SECOND PLOT ANALYZE

library(ggplot2)
library(plyr)
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
totalPM25ByYear <- tapply(NEI$Emissions, NEI$year, sum)

BaltimoreCity <- subset(NEI, fips == "24510")
totalPM25ByYear <- tapply(BaltimoreCity$Emissions, BaltimoreCity$year, sum)

plot(names(totalPM25ByYear), totalPM25ByYear, type = "l", xlab = "Year", 
+     ylab = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"),
+     main = expression("Total Baltimore City" ~ PM[2.5] ~ "Emissions by Year"))
typePM25ByYear <- ddply(BaltimoreCity, .(year, type), function(x) sum(x$Emissions))
colnames(typePM25ByYear)[3] <- "Emissions"

qplot(year, Emissions, data = typePM25ByYear, color = type, geom = "line") +
+     ggtitle(expression("Baltimore City" ~ PM[2.5] ~ 
+                            "Emissions by Source Type and Year")) + xlab("Year") +
+     ylab(expression("Total" ~ PM[2.5] ~ "Emissions (tons)"))
