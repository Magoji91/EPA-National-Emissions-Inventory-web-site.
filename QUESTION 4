Across the United States, how have emissions from coal combustion-related sources changed from 1999â€“2008?

R - The use of coal as fuel has decreased over the years which contributes to the decrease of the emission of pollutants emitted by its burning in the period from 1999 to 2008.

CoalCombustionSCC <- subset(SCC, EI.Sector %in% c("Fuel Comb - 
+                             Comm/Institutional - Coal",
+                                                   "Fuel Comb - Electric Generation - Coal",
+                                                   "Fuel Comb - Industrial Boilers, ICEs - Coal"))
CoalCombustionSCC1 <- subset(SCC, grepl("Comb", Short.Name) & grepl("Coal", 
+                                                                     Short.Name))
 
nrow(CoalCombustionSCC)
[1] 68
nrow(CoalCombustionSCC1)
[1] 91
d3 <- setdiff(CoalCombustionSCC$SCC, CoalCombustionSCC1$SCC)
d4 <- setdiff(CoalCombustionSCC1$SCC, CoalCombustionSCC$SCC)
length(d3)
[1] 10
length(d4)
[1] 33
CoalCombustionSCCCodes <- union(CoalCombustionSCC$SCC, CoalCombustionSCC1$SCC)
length(CoalCombustionSCCCodes)
[1] 101
CoalCombustion <- subset(NEI, SCC %in% CoalCombustionSCCCodes)

coalCombustionPM25ByYear <- ddply(CoalCombustion, .(year, type), function(x) 
+     sum(x$Emissions))
colnames(coalCombustionPM25ByYear)[3] <- "Emissions"

qplot(year, Emissions, data = coalCombustionPM25ByYear, color = type, 
+       geom = "line") + ggtitle(expression("Coal Combustion" ~ PM[2.5] ~ 
+                                               "Emissions by Source Type and Year")) + xlab("Year") + 
+     ylab(expression  ("Total" ~ PM[2.5] ~ "Emissions (tons)"))


***OBSERVATION-SECOND GRAPH***

library(lattice)
library(plyr)
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")

SCC.coal <- grep("coal", SCC$Short.Name, ignore.case = TRUE)
SCC.coal <- SCC[SCC.coal, ]
SCC.identifiers <- as.character(SCC.coal$SCC)

NEI$SCC <- as.character(NEI$SCC)
NEI.coal <- NEI[NEI$SCC %in% SCC.identifiers, ]

aggregate.coal <- with(NEI.coal, aggregate(Emissions, by = list(year), sum))
colnames(aggregate.coal) <- c("year", "Emissions")

plot(aggregate.coal, type = "o", ylab = expression("Total Emissions, PM"[2.5]), 
    xlab = "Year", main = "Emissions and Total Coal Combustion for the United States", 
    xlim = c(1999, 2008))
polygon(aggregate.coal, col = "blue", border = "red")




